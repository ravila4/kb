<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/knowledgebase/favicon.ico"/><title>Docker</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Basic notes about using Docker"/><meta property="og:title" content="Docker"/><meta property="og:description" content="Basic notes about using Docker"/><meta property="og:url" content="https://ravila4.github.io//knowledgebase/notes/x9wl80kifhmlnfpu6n1xf28/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="3/12/2022"/><meta property="article:modified_time" content="7/28/2022"/><link rel="canonical" href="https://ravila4.github.io//knowledgebase/notes/x9wl80kifhmlnfpu6n1xf28/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/knowledgebase/_next/static/css/6704d8b11cdf07ed.css" as="style"/><link rel="stylesheet" href="/knowledgebase/_next/static/css/6704d8b11cdf07ed.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/knowledgebase/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/knowledgebase/_next/static/chunks/webpack-60a6a2c80265851f.js" defer=""></script><script src="/knowledgebase/_next/static/chunks/framework-28c999baf2863c3d.js" defer=""></script><script src="/knowledgebase/_next/static/chunks/main-d541b53801f63272.js" defer=""></script><script src="/knowledgebase/_next/static/chunks/pages/_app-d6e974934748259c.js" defer=""></script><script src="/knowledgebase/_next/static/chunks/935-4dee79e80b8641c6.js" defer=""></script><script src="/knowledgebase/_next/static/chunks/6-50972def09142ee2.js" defer=""></script><script src="/knowledgebase/_next/static/chunks/pages/notes/%5Bid%5D-78d472fa3b924116.js" defer=""></script><script src="/knowledgebase/_next/static/gn9J0RGYwGujpyy0byt1P/_buildManifest.js" defer=""></script><script src="/knowledgebase/_next/static/gn9J0RGYwGujpyy0byt1P/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout" style="margin-top:64px;display:flex;flex-direction:row"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><main class="ant-layout-content side-layout-main" style="max-width:1200px;min-width:0;display:block"><div style="padding:0 24px"><div class="main-content" role="main"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="docker">Docker<a aria-hidden="true" class="anchor-heading icon-link" href="#docker"></a></h1>
<h2 id="installing-docker">Installing Docker<a aria-hidden="true" class="anchor-heading icon-link" href="#installing-docker"></a></h2>
<p>Installation steps have changed quite frequently with new releases of Docker. I will do my best to keep this up-to date, but no guarantees. Check your current release's instructions.</p>
<h3 id="ubuntu-installation-july-2020">Ubuntu installation (July 2020)<a aria-hidden="true" class="anchor-heading icon-link" href="#ubuntu-installation-july-2020"></a></h3>
<p>Older versions of Docker were called docker, docker.io, or docker-engine. Now, the packages to install are docker-ce, docker-ce-cli, and containerd.io.</p>
<p>Official documentation:</p>
<p><a href="https://docs.docker.com/engine/install/ubuntu/">https://docs.docker.com/engine/install/ubuntu/</a></p>
<p>For Ubuntu 20.04, follow instructions <a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-use-docker-on-ubuntu-20-04">here</a>.</p>
<h3 id="fedora-installation-january-2020">Fedora installation (January 2020)<a aria-hidden="true" class="anchor-heading icon-link" href="#fedora-installation-january-2020"></a></h3>
<pre><code>sudo dnf install docker
sudo sudo systemctl enable docker.service
sudo systemctl start docker.service
</code></pre>
<p><strong>Note:</strong> Fedora 31 had problems starting the docker daemon.</p>
<p>Debugging with: <code>sudo dockerd --debug</code> shows "Devices cgroup isn't mounted". The solution was to modify the grub in order to start cgroup</p>
<pre><code>sudo dnf install -y grubby
sudo grubby --update-kernel=ALL --args="systemd.unified_cgroup_hierarchy=0"
</code></pre>
<p>Reboot computer.</p>
<p>Finally, add user to the Docker group:</p>
<pre><code>sudo groupadd docker &#x26;&#x26; sudo gpasswd -a ${USER} docker
</code></pre>
<p>Log out and in again to see changes.</p>
<h2 id="getting-docker-images">Getting Docker Images<a aria-hidden="true" class="anchor-heading icon-link" href="#getting-docker-images"></a></h2>
<p>Pull from Docker Hub:</p>
<pre><code>docker pull hub.docker.com/r/microsoft/powershell
</code></pre>
<p>We may need to specify a tag, e.g.:</p>
<pre><code>docker pull ouchc/relion3.1:ubuntu16.04
</code></pre>
<p>Search for images: <code>docker search</code></p>
<p>See installed images: <code>docker images</code></p>
<h2 id="running-containers">Running Containers<a aria-hidden="true" class="anchor-heading icon-link" href="#running-containers"></a></h2>
<p>Use <code>docker run</code> to initially run a container.</p>
<h3 id="common-options">Common options:<a aria-hidden="true" class="anchor-heading icon-link" href="#common-options"></a></h3>
<p>-d
: run in background (daemonize)</p>
<p>-i
: interactive</p>
<p>-t
: tty</p>
<p>-p
: make a port available outside container (<strong>HOST:CONTAINER</strong>)</p>
<p>-v
: mount a volume</p>
<p>--name
: assign container a name</p>
<p>--rm
: remove container when it exits</p>
<h2 id="interacting-with-containers">Interacting with containers<a aria-hidden="true" class="anchor-heading icon-link" href="#interacting-with-containers"></a></h2>
<h3 id="basic-commands">Basic commands<a aria-hidden="true" class="anchor-heading icon-link" href="#basic-commands"></a></h3>
<p>Once a container is running, you can easily start or stop it.</p>
<p>Start a container (can use an assigned name): <code>docker start</code></p>
<p>Stop a container <code>docker stop</code></p>
<p>Execute a command off a running container: <code>docker exec</code></p>
<p>Look inside container: <code>docker logs</code></p>
<h3 id="connect-to-a-container-as-root">Connect to a container as root<a aria-hidden="true" class="anchor-heading icon-link" href="#connect-to-a-container-as-root"></a></h3>
<p><code>docker exec -u 0 -it container_id /bin/bash</code></p>
<h2 id="listing-containers-in-docker">Listing Containers in Docker<a aria-hidden="true" class="anchor-heading icon-link" href="#listing-containers-in-docker"></a></h2>
<p>To show only running containers use:</p>
<pre><code>docker container ls
</code></pre>
<p>The old, shorter way of doing this is <code>docker ps</code>.</p>
<h3 id="options">Options:<a aria-hidden="true" class="anchor-heading icon-link" href="#options"></a></h3>
<p>-a
: see all containers</p>
<p>-s
: see container sizes</p>
<h2 id="clearing-non-running-containers">Clearing Non-running Containers<a aria-hidden="true" class="anchor-heading icon-link" href="#clearing-non-running-containers"></a></h2>
<p>Containers that are not running are not taking any system resources besides disk space.</p>
<p>The docker run flag <code>--rm</code> will automatically remove a container when it exits.</p>
<p>Remove a specific container: <code>docker rm 3e552code34a</code></p>
<p>Removes all stopped containers: <code>docker container prune</code></p>
<p>Clean unused containers, networks, images, and volumes: <code>docker system prune</code></p>
<h2 id="mounting-a-host-filesystem">Mounting a Host Filesystem<a aria-hidden="true" class="anchor-heading icon-link" href="#mounting-a-host-filesystem"></a></h2>
<p>Use the <code>-v</code> flag:</p>
<pre><code>docker run -v /host/directory:/container/directory -other -options image_name command_to_run
</code></pre>
<h3 id="fix-for-permissions-issues">Fix for permissions issues<a aria-hidden="true" class="anchor-heading icon-link" href="#fix-for-permissions-issues"></a></h3>
<p>In Fedora, SELinux can cause issues with mounting volumes.
The solution is to issue a SELinux rule:
<code>chcon -Rt svirt_sandbox_file_t /path/to/volume</code></p>
<p>This got easier recently since Docker finally merged a patch in docker-1.7.</p>
<p>This patch adds support for "z" and "Z" as options on the volume mounts (-v).</p>
<p>For example:</p>
<pre><code>docker run -v /var/db:/var/db:z rhel7 /bin/sh
</code></pre>
<p>Will automatically do the <code>chcon -Rt svirt_sandbox_file_t /var/db</code>.</p>
<p>Even better, you can use Z.</p>
<pre><code>docker run -v /var/db:/var/db:Z rhel7 /bin/sh
</code></pre>
<p>This will label the content inside the container with the exact MCS label that the container will run with, basically it runs <code>chcon -Rt svirt_sandbox_file_t -l s0:c1,c2 /var/db</code>,
where s0:c1,c2 differs for each container.</p>
<p>For more info: <a href="https://docs.docker.com/storage/volumes/">https://docs.docker.com/storage/volumes/</a></p>
<p><strong>e.g.</strong> to run my powershell docker container with a mounted home directory:</p>
<pre><code>docker run -v /home/ravila/:/home/ravila/:Z -it mcr.microsoft.com/powershell
</code></pre>
<h2 id="mapping-network-ports">Mapping Network Ports<a aria-hidden="true" class="anchor-heading icon-link" href="#mapping-network-ports"></a></h2>
<pre><code>docker run --name mycontainer -p 8080:8080 -p 8000:8000
</code></pre>
<h2 id="saving-changes-to-an-image">Saving Changes to an Image<a aria-hidden="true" class="anchor-heading icon-link" href="#saving-changes-to-an-image"></a></h2>
<p>If you change anything (like install new packages) in the running container and exit the container the changes are not automatically saved. If you want to save them in an image, <strong>use <code>docker commit</code></strong>.</p>
<h2 id="docker-files">Docker Files<a aria-hidden="true" class="anchor-heading icon-link" href="#docker-files"></a></h2>
<p>A simple example Dockerfile:</p>
<pre class="language-docker"><code class="language-docker"><span class="token comment"># Base image</span>
<span class="token instruction"><span class="token keyword">FROM</span> fedora:latest</span>
<span class="token instruction"><span class="token keyword">RUN</span> dnf -y update &#x26;&#x26; dnf -y install unzip openssl  &#x26;&#x26; dnf clean all</span>
<span class="token instruction"><span class="token keyword">COPY</span> UnblockNeteaseMusic-linux-arm7.zip /opt</span>
<span class="token instruction"><span class="token keyword">RUN</span> unzip /opt/UnblockNeteaseMusic-linux-arm7.zip -d /opt/</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /opt/UnblockNeteaseMusic</span>
<span class="token instruction"><span class="token keyword">RUN</span>  ./createCertificate.sh</span>
<span class="token instruction"><span class="token keyword">ENTRYPOINT</span> [<span class="token string">"/opt/UnblockNeteaseMusic/UnblockNeteaseMusic"</span>, <span class="token string">" -b"</span>, <span class="token string">" -e"</span>]</span>
<span class="token instruction"><span class="token keyword">EXPOSE</span> 443</span>
</code></pre>
<p>Docker file reference: <a href="https://docs.docker.com/engine/reference/builder/">https://docs.docker.com/engine/reference/builder/</a></p>
<p>Best practices: <a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/">https://docs.docker.com/develop/develop-images/dockerfile_best-practices/</a></p>
<h3 id="build-dockerfile">Build Dockerfile<a aria-hidden="true" class="anchor-heading icon-link" href="#build-dockerfile"></a></h3>
<p>In a directory with a Dockerfile run:</p>
<p><code>sudo docker build -t "my-image" .</code></p>
<p>If the build is successful you can see  <code>my-image</code> in docker images output.</p>
<h2 id="docker-compose">Docker Compose<a aria-hidden="true" class="anchor-heading icon-link" href="#docker-compose"></a></h2>
<p><a href="https://docs.docker.com/compose/">https://docs.docker.com/compose/</a></p>
<p><a href="https://developer.fedoraproject.org/tools/docker/compose.html">https://developer.fedoraproject.org/tools/docker/compose.html</a></p>
<p>Docker Compose is a tool to orchestrate Docker containers using a simple YAML file which describes your whole setup.</p>
<p>Installation: <code>sudo dnf install docker-compose</code></p>
<h3 id="run-a-docker-compose-file">Run a docker compose file<a aria-hidden="true" class="anchor-heading icon-link" href="#run-a-docker-compose-file"></a></h3>
<p>Create a YAML file: <code>docker-compose.yml</code>, then in the same directory, run:</p>
<p><code>docker-compose up</code></p>
<hr>
<strong>Backlinks</strong>
<ul>
<li><a href="/knowledgebase/notes/fg0husctqcykweji6k1bduj">Installation</a></li>
</ul></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#installing-docker" title="Installing Docker">Installing Docker</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#ubuntu-installation-july-2020" title="Ubuntu installation (July 2020)">Ubuntu installation (July 2020)</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#fedora-installation-january-2020" title="Fedora installation (January 2020)">Fedora installation (January 2020)</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#getting-docker-images" title="Getting Docker Images">Getting Docker Images</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#running-containers" title="Running Containers">Running Containers</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#common-options" title="Common options:">Common options:</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#interacting-with-containers" title="Interacting with containers">Interacting with containers</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#basic-commands" title="Basic commands">Basic commands</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#connect-to-a-container-as-root" title="Connect to a container as root">Connect to a container as root</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#listing-containers-in-docker" title="Listing Containers in Docker">Listing Containers in Docker</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#options" title="Options:">Options:</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#clearing-non-running-containers" title="Clearing Non-running Containers">Clearing Non-running Containers</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#mounting-a-host-filesystem" title="Mounting a Host Filesystem">Mounting a Host Filesystem</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#fix-for-permissions-issues" title="Fix for permissions issues">Fix for permissions issues</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#mapping-network-ports" title="Mapping Network Ports">Mapping Network Ports</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#saving-changes-to-an-image" title="Saving Changes to an Image">Saving Changes to an Image</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#docker-files" title="Docker Files">Docker Files</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#build-dockerfile" title="Build Dockerfile">Build Dockerfile</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#docker-compose" title="Docker Compose">Docker Compose</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#run-a-docker-compose-file" title="Run a docker compose file">Run a docker compose file</a></div></div></div></div></div></div></div></div></div></div></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></main></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"x9wl80kifhmlnfpu6n1xf28","title":"Docker","desc":"Basic notes about using Docker","updated":1658971664765,"created":1647060044895,"custom":{},"fname":"linux.docker","type":"note","vault":{"fsPath":"vault","remote":{"type":"git","url":"git@github.com:ravila4/knowledgebase.git"}},"contentHash":"72156145b286005b5f4ef760cbb94f54","links":[{"from":{"fname":"database.elasticsearch.installation","id":"fg0husctqcykweji6k1bduj","vaultName":"vault"},"type":"backlink","position":{"start":{"line":7,"column":45,"offset":81},"end":{"line":7,"column":61,"offset":97},"indent":[]},"value":"linux.docker"},{"from":{"fname":"database.elasticsearch.installation","id":"fg0husctqcykweji6k1bduj","vaultName":"vault"},"type":"backlink","position":{"start":{"line":22,"column":43,"offset":683},"end":{"line":22,"column":94,"offset":734},"indent":[]},"value":"linux.docker"}],"anchors":{"installing-docker":{"type":"header","text":"Installing Docker","value":"installing-docker","line":8,"column":0,"depth":2},"ubuntu-installation-july-2020":{"type":"header","text":"Ubuntu installation (July 2020)","value":"ubuntu-installation-july-2020","line":12,"column":0,"depth":3},"fedora-installation-january-2020":{"type":"header","text":"Fedora installation (January 2020)","value":"fedora-installation-january-2020","line":22,"column":0,"depth":3},"getting-docker-images":{"type":"header","text":"Getting Docker Images","value":"getting-docker-images","line":45,"column":0,"depth":2},"running-containers":{"type":"header","text":"Running Containers","value":"running-containers","line":59,"column":0,"depth":2},"common-options":{"type":"header","text":"Common options:","value":"common-options","line":63,"column":0,"depth":3},"interacting-with-containers":{"type":"header","text":"Interacting with containers","value":"interacting-with-containers","line":86,"column":0,"depth":2},"basic-commands":{"type":"header","text":"Basic commands","value":"basic-commands","line":88,"column":0,"depth":3},"connect-to-a-container-as-root":{"type":"header","text":"Connect to a container as root","value":"connect-to-a-container-as-root","line":100,"column":0,"depth":3},"listing-containers-in-docker":{"type":"header","text":"Listing Containers in Docker","value":"listing-containers-in-docker","line":104,"column":0,"depth":2},"options":{"type":"header","text":"Options:","value":"options","line":112,"column":0,"depth":3},"clearing-non-running-containers":{"type":"header","text":"Clearing Non-running Containers","value":"clearing-non-running-containers","line":122,"column":0,"depth":2},"mounting-a-host-filesystem":{"type":"header","text":"Mounting a Host Filesystem","value":"mounting-a-host-filesystem","line":134,"column":0,"depth":2},"fix-for-permissions-issues":{"type":"header","text":"Fix for permissions issues","value":"fix-for-permissions-issues","line":141,"column":0,"depth":3},"mapping-network-ports":{"type":"header","text":"Mapping Network Ports","value":"mapping-network-ports","line":173,"column":0,"depth":2},"saving-changes-to-an-image":{"type":"header","text":"Saving Changes to an Image","value":"saving-changes-to-an-image","line":177,"column":0,"depth":2},"docker-files":{"type":"header","text":"Docker Files","value":"docker-files","line":182,"column":0,"depth":2},"build-dockerfile":{"type":"header","text":"Build Dockerfile","value":"build-dockerfile","line":203,"column":0,"depth":3},"docker-compose":{"type":"header","text":"Docker Compose","value":"docker-compose","line":211,"column":0,"depth":2},"run-a-docker-compose-file":{"type":"header","text":"Run a docker compose file","value":"run-a-docker-compose-file","line":221,"column":0,"depth":3}},"children":[],"parent":"77irrssbs1ld66im3uhw4yx","data":{}},"body":"\u003ch1 id=\"docker\"\u003eDocker\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#docker\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003ch2 id=\"installing-docker\"\u003eInstalling Docker\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#installing-docker\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eInstallation steps have changed quite frequently with new releases of Docker. I will do my best to keep this up-to date, but no guarantees. Check your current release's instructions.\u003c/p\u003e\n\u003ch3 id=\"ubuntu-installation-july-2020\"\u003eUbuntu installation (July 2020)\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#ubuntu-installation-july-2020\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eOlder versions of Docker were called docker, docker.io, or docker-engine. Now, the packages to install are docker-ce, docker-ce-cli, and containerd.io.\u003c/p\u003e\n\u003cp\u003eOfficial documentation:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://docs.docker.com/engine/install/ubuntu/\"\u003ehttps://docs.docker.com/engine/install/ubuntu/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eFor Ubuntu 20.04, follow instructions \u003ca href=\"https://www.digitalocean.com/community/tutorials/how-to-install-and-use-docker-on-ubuntu-20-04\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\n\u003ch3 id=\"fedora-installation-january-2020\"\u003eFedora installation (January 2020)\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#fedora-installation-january-2020\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003esudo dnf install docker\nsudo sudo systemctl enable docker.service\nsudo systemctl start docker.service\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eNote:\u003c/strong\u003e Fedora 31 had problems starting the docker daemon.\u003c/p\u003e\n\u003cp\u003eDebugging with: \u003ccode\u003esudo dockerd --debug\u003c/code\u003e shows \"Devices cgroup isn't mounted\". The solution was to modify the grub in order to start cgroup\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003esudo dnf install -y grubby\nsudo grubby --update-kernel=ALL --args=\"systemd.unified_cgroup_hierarchy=0\"\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eReboot computer.\u003c/p\u003e\n\u003cp\u003eFinally, add user to the Docker group:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003esudo groupadd docker \u0026#x26;\u0026#x26; sudo gpasswd -a ${USER} docker\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eLog out and in again to see changes.\u003c/p\u003e\n\u003ch2 id=\"getting-docker-images\"\u003eGetting Docker Images\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#getting-docker-images\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003ePull from Docker Hub:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003edocker pull hub.docker.com/r/microsoft/powershell\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWe may need to specify a tag, e.g.:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003edocker pull ouchc/relion3.1:ubuntu16.04\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eSearch for images: \u003ccode\u003edocker search\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eSee installed images: \u003ccode\u003edocker images\u003c/code\u003e\u003c/p\u003e\n\u003ch2 id=\"running-containers\"\u003eRunning Containers\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#running-containers\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eUse \u003ccode\u003edocker run\u003c/code\u003e to initially run a container.\u003c/p\u003e\n\u003ch3 id=\"common-options\"\u003eCommon options:\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#common-options\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e-d\n: run in background (daemonize)\u003c/p\u003e\n\u003cp\u003e-i\n: interactive\u003c/p\u003e\n\u003cp\u003e-t\n: tty\u003c/p\u003e\n\u003cp\u003e-p\n: make a port available outside container (\u003cstrong\u003eHOST:CONTAINER\u003c/strong\u003e)\u003c/p\u003e\n\u003cp\u003e-v\n: mount a volume\u003c/p\u003e\n\u003cp\u003e--name\n: assign container a name\u003c/p\u003e\n\u003cp\u003e--rm\n: remove container when it exits\u003c/p\u003e\n\u003ch2 id=\"interacting-with-containers\"\u003eInteracting with containers\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#interacting-with-containers\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003ch3 id=\"basic-commands\"\u003eBasic commands\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#basic-commands\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eOnce a container is running, you can easily start or stop it.\u003c/p\u003e\n\u003cp\u003eStart a container (can use an assigned name): \u003ccode\u003edocker start\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eStop a container \u003ccode\u003edocker stop\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eExecute a command off a running container: \u003ccode\u003edocker exec\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eLook inside container: \u003ccode\u003edocker logs\u003c/code\u003e\u003c/p\u003e\n\u003ch3 id=\"connect-to-a-container-as-root\"\u003eConnect to a container as root\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#connect-to-a-container-as-root\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003edocker exec -u 0 -it container_id /bin/bash\u003c/code\u003e\u003c/p\u003e\n\u003ch2 id=\"listing-containers-in-docker\"\u003eListing Containers in Docker\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#listing-containers-in-docker\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eTo show only running containers use:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003edocker container ls\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe old, shorter way of doing this is \u003ccode\u003edocker ps\u003c/code\u003e.\u003c/p\u003e\n\u003ch3 id=\"options\"\u003eOptions:\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#options\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e-a\n: see all containers\u003c/p\u003e\n\u003cp\u003e-s\n: see container sizes\u003c/p\u003e\n\u003ch2 id=\"clearing-non-running-containers\"\u003eClearing Non-running Containers\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#clearing-non-running-containers\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eContainers that are not running are not taking any system resources besides disk space.\u003c/p\u003e\n\u003cp\u003eThe docker run flag \u003ccode\u003e--rm\u003c/code\u003e will automatically remove a container when it exits.\u003c/p\u003e\n\u003cp\u003eRemove a specific container: \u003ccode\u003edocker rm 3e552code34a\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eRemoves all stopped containers: \u003ccode\u003edocker container prune\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eClean unused containers, networks, images, and volumes: \u003ccode\u003edocker system prune\u003c/code\u003e\u003c/p\u003e\n\u003ch2 id=\"mounting-a-host-filesystem\"\u003eMounting a Host Filesystem\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#mounting-a-host-filesystem\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eUse the \u003ccode\u003e-v\u003c/code\u003e flag:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003edocker run -v /host/directory:/container/directory -other -options image_name command_to_run\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"fix-for-permissions-issues\"\u003eFix for permissions issues\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#fix-for-permissions-issues\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eIn Fedora, SELinux can cause issues with mounting volumes.\nThe solution is to issue a SELinux rule:\n\u003ccode\u003echcon -Rt svirt_sandbox_file_t /path/to/volume\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eThis got easier recently since Docker finally merged a patch in docker-1.7.\u003c/p\u003e\n\u003cp\u003eThis patch adds support for \"z\" and \"Z\" as options on the volume mounts (-v).\u003c/p\u003e\n\u003cp\u003eFor example:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003edocker run -v /var/db:/var/db:z rhel7 /bin/sh\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWill automatically do the \u003ccode\u003echcon -Rt svirt_sandbox_file_t /var/db\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eEven better, you can use Z.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003edocker run -v /var/db:/var/db:Z rhel7 /bin/sh\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis will label the content inside the container with the exact MCS label that the container will run with, basically it runs \u003ccode\u003echcon -Rt svirt_sandbox_file_t -l s0:c1,c2 /var/db\u003c/code\u003e,\nwhere s0:c1,c2 differs for each container.\u003c/p\u003e\n\u003cp\u003eFor more info: \u003ca href=\"https://docs.docker.com/storage/volumes/\"\u003ehttps://docs.docker.com/storage/volumes/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003ee.g.\u003c/strong\u003e to run my powershell docker container with a mounted home directory:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003edocker run -v /home/ravila/:/home/ravila/:Z -it mcr.microsoft.com/powershell\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"mapping-network-ports\"\u003eMapping Network Ports\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#mapping-network-ports\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003edocker run --name mycontainer -p 8080:8080 -p 8000:8000\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"saving-changes-to-an-image\"\u003eSaving Changes to an Image\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#saving-changes-to-an-image\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eIf you change anything (like install new packages) in the running container and exit the container the changes are not automatically saved. If you want to save them in an image, \u003cstrong\u003euse \u003ccode\u003edocker commit\u003c/code\u003e\u003c/strong\u003e.\u003c/p\u003e\n\u003ch2 id=\"docker-files\"\u003eDocker Files\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#docker-files\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eA simple example Dockerfile:\u003c/p\u003e\n\u003cpre class=\"language-docker\"\u003e\u003ccode class=\"language-docker\"\u003e\u003cspan class=\"token comment\"\u003e# Base image\u003c/span\u003e\n\u003cspan class=\"token instruction\"\u003e\u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e fedora:latest\u003c/span\u003e\n\u003cspan class=\"token instruction\"\u003e\u003cspan class=\"token keyword\"\u003eRUN\u003c/span\u003e dnf -y update \u0026#x26;\u0026#x26; dnf -y install unzip openssl  \u0026#x26;\u0026#x26; dnf clean all\u003c/span\u003e\n\u003cspan class=\"token instruction\"\u003e\u003cspan class=\"token keyword\"\u003eCOPY\u003c/span\u003e UnblockNeteaseMusic-linux-arm7.zip /opt\u003c/span\u003e\n\u003cspan class=\"token instruction\"\u003e\u003cspan class=\"token keyword\"\u003eRUN\u003c/span\u003e unzip /opt/UnblockNeteaseMusic-linux-arm7.zip -d /opt/\u003c/span\u003e\n\u003cspan class=\"token instruction\"\u003e\u003cspan class=\"token keyword\"\u003eWORKDIR\u003c/span\u003e /opt/UnblockNeteaseMusic\u003c/span\u003e\n\u003cspan class=\"token instruction\"\u003e\u003cspan class=\"token keyword\"\u003eRUN\u003c/span\u003e  ./createCertificate.sh\u003c/span\u003e\n\u003cspan class=\"token instruction\"\u003e\u003cspan class=\"token keyword\"\u003eENTRYPOINT\u003c/span\u003e [\u003cspan class=\"token string\"\u003e\"/opt/UnblockNeteaseMusic/UnblockNeteaseMusic\"\u003c/span\u003e, \u003cspan class=\"token string\"\u003e\" -b\"\u003c/span\u003e, \u003cspan class=\"token string\"\u003e\" -e\"\u003c/span\u003e]\u003c/span\u003e\n\u003cspan class=\"token instruction\"\u003e\u003cspan class=\"token keyword\"\u003eEXPOSE\u003c/span\u003e 443\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eDocker file reference: \u003ca href=\"https://docs.docker.com/engine/reference/builder/\"\u003ehttps://docs.docker.com/engine/reference/builder/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eBest practices: \u003ca href=\"https://docs.docker.com/develop/develop-images/dockerfile_best-practices/\"\u003ehttps://docs.docker.com/develop/develop-images/dockerfile_best-practices/\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"build-dockerfile\"\u003eBuild Dockerfile\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#build-dockerfile\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eIn a directory with a Dockerfile run:\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003esudo docker build -t \"my-image\" .\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eIf the build is successful you can see  \u003ccode\u003emy-image\u003c/code\u003e in docker images output.\u003c/p\u003e\n\u003ch2 id=\"docker-compose\"\u003eDocker Compose\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#docker-compose\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://docs.docker.com/compose/\"\u003ehttps://docs.docker.com/compose/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://developer.fedoraproject.org/tools/docker/compose.html\"\u003ehttps://developer.fedoraproject.org/tools/docker/compose.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eDocker Compose is a tool to orchestrate Docker containers using a simple YAML file which describes your whole setup.\u003c/p\u003e\n\u003cp\u003eInstallation: \u003ccode\u003esudo dnf install docker-compose\u003c/code\u003e\u003c/p\u003e\n\u003ch3 id=\"run-a-docker-compose-file\"\u003eRun a docker compose file\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#run-a-docker-compose-file\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eCreate a YAML file: \u003ccode\u003edocker-compose.yml\u003c/code\u003e, then in the same directory, run:\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003edocker-compose up\u003c/code\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cstrong\u003eBacklinks\u003c/strong\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/knowledgebase/notes/fg0husctqcykweji6k1bduj\"\u003eInstallation\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","noteIndex":{"id":"i3e9kusp519n36iz1ioi387","title":"Ricardo's Notes","desc":"","updated":1660963919727,"created":1647055090448,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"vault","remote":{"type":"git","url":"git@github.com:ravila4/knowledgebase.git"}},"contentHash":"9cb227c82d046533deea61e24c8a1c1e","links":[],"anchors":{"welcome-to-my-personal-knowledge-base":{"type":"header","text":"Welcome to my Personal Knowledge Base!","value":"welcome-to-my-personal-knowledge-base","line":8,"column":0,"depth":2},"my-links":{"type":"header","text":"My Links","value":"my-links","line":18,"column":0,"depth":2}},"children":["lf1bfgnfsc4s7uh9qsnefdw","qz307gmzctlyybze4spt8ug","jgwsrsqomd2kd3cj73wg804","e0dxh083vpjhkdjw955e2xv","9y8uvew2sqdfv2ftqyolhfg","9m1s0nes0vm0a7mlbgw5hv7","pju469ro805gknxx6p4lvar","jro9xnfg791cmppo1p7oc90","7bg28rkj42r5n52oxwezco3","77irrssbs1ld66im3uhw4yx","mnoouhphnmr5mdj6is5oaz6","bfuvlavhie001y6cersdn98","lkcpotdu9x59v4mh3u6z077"],"parent":null,"data":{},"body":"\n## Welcome to my Personal Knowledge Base!\n\n![](/assets/images/profile.jpg)\n\nI am a bioinformatics programmer, currently working at the Scripps Research Institute.\n\nI enjoy learning about technology, science, and art. ðŸ’» ðŸ§¬ ðŸŽ¨\n\nThis is my attempt at organizing and offloading knowledge from topics that I come across often, but not necessarily use on a daily basis, or things that I am in the process of learning.\n\n## My Links\n\n[GitHub](https://github.com/ravila4)\n\n[LinkedIn](https://linkedin.com/in/ravila4)"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":"vault","remote":{"type":"git","url":"git@github.com:ravila4/knowledgebase.git"}}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableFullHierarchyNoteTitle":false,"dendronVersion":"0.108.0"},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Home","description":"My Personal Knowledge Base","author":"Ricardo Avila"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"lookup","theme":"custom","siteUrl":"https://ravila4.github.io/","assetsPrefix":"/knowledgebase","siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"x9wl80kifhmlnfpu6n1xf28"},"buildId":"gn9J0RGYwGujpyy0byt1P","assetPrefix":"/knowledgebase","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>