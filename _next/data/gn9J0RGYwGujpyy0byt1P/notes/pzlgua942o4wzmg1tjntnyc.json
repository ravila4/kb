{"pageProps":{"note":{"id":"pzlgua942o4wzmg1tjntnyc","title":"Scripts","desc":"","updated":1660969432369,"created":1647059949753,"custom":{},"fname":"linux.bash.scripts","type":"note","vault":{"fsPath":"vault","remote":{"type":"git","url":"git@github.com:ravila4/knowledgebase.git"}},"contentHash":"62ac28fb38becd9633f2326268d3dc92","links":[],"anchors":{"starting-scripts":{"type":"header","text":"Starting scripts","value":"starting-scripts","line":11,"column":0,"depth":2},"set":{"type":"header","text":"Set","value":"set","line":20,"column":0,"depth":3},"a-general-template-for-bash-scripts":{"type":"header","text":"A general template for BASH scripts","value":"a-general-template-for-bash-scripts","line":40,"column":0,"depth":2}},"children":[],"parent":"t6vre0j2jqp10vmdhnyxgca","data":{}},"body":"<h1 id=\"scripts\">Scripts<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#scripts\"></a></h1>\n<p>This document collects basic syntax and best practices for writing\nBASH scripts.</p>\n<h2 id=\"starting-scripts\">Starting scripts<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#starting-scripts\"></a></h2>\n<p>It is good practice to start BASH scripts with the following lines:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/bash</span>\n\n<span class=\"token builtin class-name\">set</span> -euo pipefail\n</code></pre>\n<h3 id=\"set\">Set<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#set\"></a></h3>\n<p>The command <code>set</code> allows you to change shell options. The most useful flags are:</p>\n<p>-e\n: Stop execution when an error is encountered.\nYou can \"catch\" an error to prevent the shell from exiting by appending <code>|| true</code> after a failing command.</p>\n<p>-o pipefail\n: Catch errors in pipes. Return zero exit status only if all commands in a pipeline succeed.</p>\n<p>-u\n: Error out when shell encounters undefined variables by their values.</p>\n<p>-x\n: Debug mode. Prints every line and output, substituting variables</p>\n<p>-f\n: Disable file globbing.</p>\n<h2 id=\"a-general-template-for-bash-scripts\">A general template for BASH scripts<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#a-general-template-for-bash-scripts\"></a></h2>\n<p>This template contains the most common boilerplate code for a CLI application:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\">\n```bash\n\n<span class=\"token comment\">#!/usr/bin/env bash</span>\n\n<span class=\"token builtin class-name\">set</span> -Eeuo pipefail\n\n<span class=\"token builtin class-name\">cd</span> <span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">dirname</span> <span class=\"token string\">\"<span class=\"token variable\">${<span class=\"token environment constant\">BASH_SOURCE</span><span class=\"token punctuation\">[</span>0<span class=\"token punctuation\">]</span>}</span>\"</span><span class=\"token variable\">)</span></span>\"</span> <span class=\"token operator\">></span>/dev/null <span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span><span class=\"token file-descriptor important\">&#x26;1</span>\n\n<span class=\"token builtin class-name\">trap</span> cleanup SIGINT SIGTERM ERR EXIT\n\n<span class=\"token function-name function\">usage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">cat</span> <span class=\"token operator\">&#x3C;&#x3C;</span><span class=\"token string\">EOF\nUsage: <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">basename</span> <span class=\"token string\">\"<span class=\"token variable\">$0</span>\"</span><span class=\"token variable\">)</span></span> [-h] [-v] [-f] -p param_value arg1 [arg2...]\nScript description here.\nAvailable options:\n-h, --help      Print this help and exit\n-v, --verbose   Print script debug info\n-f, --flag      Some flag description\n-p, --param     Some param description\nEOF</span>\n  <span class=\"token builtin class-name\">exit</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function-name function\">cleanup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin class-name\">trap</span> - SIGINT SIGTERM ERR EXIT\n  <span class=\"token comment\"># script cleanup here</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function-name function\">setup_colors</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span> -t <span class=\"token number\">2</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&#x26;&#x26;</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span> -z <span class=\"token string\">\"<span class=\"token variable\">${NO_COLOR-}</span>\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&#x26;&#x26;</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">${<span class=\"token environment constant\">TERM</span>-}</span>\"</span> <span class=\"token operator\">!=</span> <span class=\"token string\">\"dumb\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n    <span class=\"token assign-left variable\">NOCOLOR</span><span class=\"token operator\">=</span><span class=\"token string\">'\\033[0m'</span> <span class=\"token assign-left variable\">RED</span><span class=\"token operator\">=</span><span class=\"token string\">'\\033[0;31m'</span> <span class=\"token assign-left variable\">GREEN</span><span class=\"token operator\">=</span><span class=\"token string\">'\\033[0;32m'</span> <span class=\"token assign-left variable\">ORANGE</span><span class=\"token operator\">=</span><span class=\"token string\">'\\033[0;33m'</span> <span class=\"token assign-left variable\">BLUE</span><span class=\"token operator\">=</span><span class=\"token string\">'\\033[0;34m'</span> <span class=\"token assign-left variable\">PURPLE</span><span class=\"token operator\">=</span><span class=\"token string\">'\\033[0;35m'</span> <span class=\"token assign-left variable\">CYAN</span><span class=\"token operator\">=</span><span class=\"token string\">'\\033[0;36m'</span> <span class=\"token assign-left variable\">YELLOW</span><span class=\"token operator\">=</span><span class=\"token string\">'\\033[1;33m'</span>\n  <span class=\"token keyword\">else</span>\n    <span class=\"token assign-left variable\">NOCOLOR</span><span class=\"token operator\">=</span><span class=\"token string\">''</span> <span class=\"token assign-left variable\">RED</span><span class=\"token operator\">=</span><span class=\"token string\">''</span> <span class=\"token assign-left variable\">GREEN</span><span class=\"token operator\">=</span><span class=\"token string\">''</span> <span class=\"token assign-left variable\">ORANGE</span><span class=\"token operator\">=</span><span class=\"token string\">''</span> <span class=\"token assign-left variable\">BLUE</span><span class=\"token operator\">=</span><span class=\"token string\">''</span> <span class=\"token assign-left variable\">PURPLE</span><span class=\"token operator\">=</span><span class=\"token string\">''</span> <span class=\"token assign-left variable\">CYAN</span><span class=\"token operator\">=</span><span class=\"token string\">''</span> <span class=\"token assign-left variable\">YELLOW</span><span class=\"token operator\">=</span><span class=\"token string\">''</span>\n  <span class=\"token keyword\">fi</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function-name function\">msg</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin class-name\">echo</span> <span class=\"token operator\">></span><span class=\"token file-descriptor important\">&#x26;2</span> -e <span class=\"token string\">\"<span class=\"token variable\">${1-}</span>\"</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function-name function\">die</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin class-name\">local</span> <span class=\"token assign-left variable\">msg</span><span class=\"token operator\">=</span><span class=\"token variable\">$1</span>\n  <span class=\"token builtin class-name\">local</span> <span class=\"token assign-left variable\">code</span><span class=\"token operator\">=</span><span class=\"token variable\">${2-1}</span> <span class=\"token comment\"># default exit status 1</span>\n  msg <span class=\"token string\">\"<span class=\"token variable\">$msg</span>\"</span>\n  <span class=\"token builtin class-name\">exit</span> <span class=\"token string\">\"<span class=\"token variable\">$code</span>\"</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function-name function\">parse_params</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\"># default values of variables set from params</span>\n  <span class=\"token assign-left variable\">flag</span><span class=\"token operator\">=</span><span class=\"token number\">0</span>\n  <span class=\"token assign-left variable\">param</span><span class=\"token operator\">=</span><span class=\"token string\">''</span>\n\n  <span class=\"token keyword\">while</span> <span class=\"token builtin class-name\">:</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">do</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">\"<span class=\"token variable\">${1-}</span>\"</span> <span class=\"token keyword\">in</span>\n    -h <span class=\"token operator\">|</span> --help<span class=\"token punctuation\">)</span>\n      usage\n      <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n    -v <span class=\"token operator\">|</span> --verbose<span class=\"token punctuation\">)</span>\n      <span class=\"token builtin class-name\">set</span> -x\n      <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n    --no-color<span class=\"token punctuation\">)</span>\n      <span class=\"token assign-left variable\">NO_COLOR</span><span class=\"token operator\">=</span><span class=\"token number\">1</span>\n      <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n    -f <span class=\"token operator\">|</span> --flag<span class=\"token punctuation\">)</span> <span class=\"token comment\"># example flag</span>\n      <span class=\"token assign-left variable\">flag</span><span class=\"token operator\">=</span><span class=\"token number\">1</span>\n      <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n    -p <span class=\"token operator\">|</span> --param<span class=\"token punctuation\">)</span> <span class=\"token comment\"># example named parameter</span>\n      <span class=\"token assign-left variable\">param</span><span class=\"token operator\">=</span><span class=\"token string\">\"<span class=\"token variable\">${2-}</span>\"</span>\n      <span class=\"token builtin class-name\">shift</span>\n      <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n    -?*<span class=\"token punctuation\">)</span>\n      die <span class=\"token string\">\"Unknown option: <span class=\"token variable\">$1</span>\"</span>\n      <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n    *<span class=\"token punctuation\">)</span>\n      <span class=\"token builtin class-name\">break</span>\n      <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">esac</span>\n    <span class=\"token builtin class-name\">shift</span>\n  <span class=\"token keyword\">done</span>\n\n  <span class=\"token assign-left variable\">args</span><span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"<span class=\"token variable\">$@</span>\"</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\"># check required params and arguments</span>\n  <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span> -z <span class=\"token string\">\"<span class=\"token variable\">${param-}</span>\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&#x26;&#x26;</span> die <span class=\"token string\">\"Missing required parameter: param\"</span>\n  <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span> <span class=\"token variable\">${<span class=\"token operator\">#</span>args<span class=\"token punctuation\">[</span>@<span class=\"token punctuation\">]</span>}</span> -eq <span class=\"token number\">0</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&#x26;&#x26;</span> die <span class=\"token string\">\"Missing script arguments\"</span>\n\n  <span class=\"token builtin class-name\">return</span> <span class=\"token number\">0</span>\n<span class=\"token punctuation\">}</span>\n\nparse_params <span class=\"token string\">\"<span class=\"token variable\">$@</span>\"</span>\nsetup_colors\n\n<span class=\"token comment\"># script logic here</span>\n\nmsg <span class=\"token string\">\"<span class=\"token variable\">${RED}</span>Read parameters:<span class=\"token variable\">${NOCOLOR}</span>\"</span>\nmsg <span class=\"token string\">\"- flag: <span class=\"token variable\">${flag}</span>\"</span>\nmsg <span class=\"token string\">\"- param: <span class=\"token variable\">${param}</span>\"</span>\nmsg <span class=\"token string\">\"- arguments: <span class=\"token variable\">${args<span class=\"token punctuation\">[</span>*<span class=\"token punctuation\">]</span>-}</span>\"</span>\n\n</code></pre>","noteIndex":{"id":"i3e9kusp519n36iz1ioi387","title":"Ricardo's Notes","desc":"","updated":1660963919727,"created":1647055090448,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"vault","remote":{"type":"git","url":"git@github.com:ravila4/knowledgebase.git"}},"contentHash":"9cb227c82d046533deea61e24c8a1c1e","links":[],"anchors":{"welcome-to-my-personal-knowledge-base":{"type":"header","text":"Welcome to my Personal Knowledge Base!","value":"welcome-to-my-personal-knowledge-base","line":8,"column":0,"depth":2},"my-links":{"type":"header","text":"My Links","value":"my-links","line":18,"column":0,"depth":2}},"children":["lf1bfgnfsc4s7uh9qsnefdw","qz307gmzctlyybze4spt8ug","jgwsrsqomd2kd3cj73wg804","e0dxh083vpjhkdjw955e2xv","9y8uvew2sqdfv2ftqyolhfg","9m1s0nes0vm0a7mlbgw5hv7","pju469ro805gknxx6p4lvar","jro9xnfg791cmppo1p7oc90","7bg28rkj42r5n52oxwezco3","77irrssbs1ld66im3uhw4yx","mnoouhphnmr5mdj6is5oaz6","bfuvlavhie001y6cersdn98","lkcpotdu9x59v4mh3u6z077"],"parent":null,"data":{},"body":"\n## Welcome to my Personal Knowledge Base!\n\n![](/assets/images/profile.jpg)\n\nI am a bioinformatics programmer, currently working at the Scripps Research Institute.\n\nI enjoy learning about technology, science, and art. ðŸ’» ðŸ§¬ ðŸŽ¨\n\nThis is my attempt at organizing and offloading knowledge from topics that I come across often, but not necessarily use on a daily basis, or things that I am in the process of learning.\n\n## My Links\n\n[GitHub](https://github.com/ravila4)\n\n[LinkedIn](https://linkedin.com/in/ravila4)"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":"vault","remote":{"type":"git","url":"git@github.com:ravila4/knowledgebase.git"}}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableFullHierarchyNoteTitle":false,"dendronVersion":"0.108.0"},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Home","description":"My Personal Knowledge Base","author":"Ricardo Avila"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"lookup","theme":"custom","siteUrl":"https://ravila4.github.io/","assetsPrefix":"/knowledgebase","siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true}